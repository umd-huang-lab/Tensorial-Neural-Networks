\begin{table}[!htbp]
\vspace{-1em}
\caption{\textbf{Maximum batch size for a video classification task for spatial (S) and temporal (T) streams of two-stream network.} The maximal batch size allowed for data under varying compression rates and using different libraries. "ckpt" = checkpointing. %using \texttt{conv\_einsum} and \pytorch with/without checkpointing.
}
 \label{tab:video-max-batch-size}
  \centering
  \resizebox{\linewidth}{!}{
  \begin{tabular}{lcccccc}
    \toprule
    & \multicolumn{2}{c}{\conveinsum} & \multicolumn{2}{c}{\shortstack{\pytorch w/ ckpt}} & \multicolumn{2}{c}{\shortstack{\pytorch w/o ckpt}} \\
    \cmidrule(lr){2-3}\cmidrule(lr){4-5}\cmidrule(lr){6-7}
    \thead{CR} & \thead{S} & \thead{T} & \thead{S} & \thead{T} & \thead{S} & \thead{T}\\
    \midrule
    1\% & 20 & 30 & 2 & 4 & 1 & 2\\
    2\% & 20 & 30 & 2 & 4 & 0 & 0\\
    5\% & 20 & 30 & 2 & 4 & 0 & 0\\
    10\% & 18 & 30 & 1 & 2 & 0 & 0\\
    20\% & 16 & 27 & 0 & 0 & 0 & 0\\
    50\% & 12 & 22 & 0 & 0 & 0 & 0\\
    100\% & 4 & 14 & 0 & 0 & 0 & 0\\
    \bottomrule
 \end{tabular}}
 \vspace{-1em}
\end{table}